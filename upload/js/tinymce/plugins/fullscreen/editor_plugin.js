(function(){var i="fullscreen",t=tinymce.DOM;tinymce.create("tinymce.plugins.FullScreenPlugin",{init:function(r,u){var c="fullscreen_is_enabled",l="mceFullScreen",a=".bbCodeEditorButton",s="mce_fullscreen",e=this,f={},o,h;e.editor=r,r.onPostRender.add(function(n){if(n.id==s){var u,r=t.doc.documentElement;t.win.setTimeout(function(){$(a).hide()},10)}}),r.addCommand(l,function(){var l="auto",i="overflow",v="mce_fullscreen_container",w="fullscreen_new_window",p,y=t.doc.documentElement;if(tinyMCE.activeEditor.id==s&&$(a).show(),r.getParam(c)){r.getParam(w)?closeFullscreen():t.win.setTimeout(function(){tinymce.dom.Event.remove(t.win,"resize",e.resizeFunc),tinyMCE.get(r.getParam("fullscreen_editor_id")).setContent(r.getContent()),tinyMCE.execCommand("mceRemoveControl",!1,s),t.remove(v),y.style.overflow=r.getParam("fullscreen_html_overflow"),t.setStyle(t.doc.body,i,r.getParam("fullscreen_overflow")),t.win.scrollTo(r.getParam("fullscreen_scrollx"),r.getParam("fullscreen_scrolly")),tinyMCE.settings=tinyMCE.oldSettings},10);return}if(r.getParam(w)){p=t.win.open(u+"/fullscreen.htm","mceFullScreenPopup","fullscreen=yes,menubar=no,toolbar=no,scrollbars=no,resizable=yes,left=0,top=0,width="+screen.availWidth+",height="+screen.availHeight);try{p.resizeTo(screen.availWidth,screen.availHeight)}catch(b){}}else tinyMCE.oldSettings=tinyMCE.settings,f.fullscreen_overflow=t.getStyle(t.doc.body,i,1)||l,f.fullscreen_html_overflow=t.getStyle(y,i,1),o=t.getViewPort(),f.fullscreen_scrollx=o.x,f.fullscreen_scrolly=o.y,tinymce.isOpera&&f.fullscreen_overflow=="visible"&&(f.fullscreen_overflow=l),tinymce.isIE&&f.fullscreen_overflow=="scroll"&&(f.fullscreen_overflow=l),tinymce.isIE&&(f.fullscreen_html_overflow=="visible"||f.fullscreen_html_overflow=="scroll")&&(f.fullscreen_html_overflow=l),f.fullscreen_overflow=="0px"&&(f.fullscreen_overflow=""),t.setStyle(t.doc.body,i,"hidden"),y.style.overflow="hidden",o=t.getViewPort(),t.win.scrollTo(0,0),tinymce.isIE&&(o.h-=1),h=tinymce.isIE6||document.compatMode=="BackCompat"?"absolute;top:"+o.y:"fixed;top:0",n=t.add(t.doc.body,"div",{id:v,style:"position:"+h+";left:0;width:"+o.w+"px;height:"+o.h+"px;z-index:200000;"}),t.add(n,"div",{id:s}),tinymce.each(r.settings,function(n,t){f[t]=n}),f.id=s,f.width=n.clientWidth,f.height=n.clientHeight-15,f.fullscreen_is_enabled=!0,f.fullscreen_editor_id=r.id,f.theme_xenforo_resizing=!1,f.save_onsavecallback=function(){r.setContent(tinyMCE.get(f.id).getContent()),r.execCommand("mceSave")},tinymce.each(r.getParam("fullscreen_settings"),function(n,t){f[t]=n}),f.theme_xenforo_toolbar_location==="external"&&(f.theme_xenforo_toolbar_location="top"),e.fullscreenEditor=new tinymce.Editor(s,f),e.fullscreenEditor.onInit.add(function(){e.fullscreenEditor.setContent(r.getContent()),e.fullscreenEditor.focus()}),e.fullscreenEditor.render(),e.fullscreenElement=new tinymce.dom.Element(v),e.fullscreenElement.update(),e.resizeFunc=tinymce.dom.Event.add(t.win,"resize",function(){var r=tinymce.DOM.getViewPort(),n=e.fullscreenEditor,t,i;t=n.dom.getSize(n.getContainer().getElementsByTagName("table")[0]),i=n.dom.getSize(n.getContainer().getElementsByTagName("iframe")[0]),n.theme.resizeTo(r.w-t.w+i.w,r.h-t.h+i.h)})}),r.addButton(i,{title:"xenforo.fullscreen_desc",cmd:l}),r.onNodeChange.add(function(n,t){t.setActive(i,n.getParam(c))})},getInfo:function(){return{longname:"Fullscreen",author:"Moxiecode Systems AB",authorurl:"http://tinymce.moxiecode.com",infourl:"http://wiki.moxiecode.com/index.php/TinyMCE:Plugins/fullscreen",version:tinymce.majorVersion+"."+tinymce.minorVersion}}}),tinymce.PluginManager.add(i,tinymce.plugins.FullScreenPlugin)})();